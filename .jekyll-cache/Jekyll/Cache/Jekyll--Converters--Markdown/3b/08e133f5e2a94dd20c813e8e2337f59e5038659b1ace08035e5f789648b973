I"—ø<p>ä¸ºäº†æ›´å¥½åœ°ä»‹ç»hitsç®—æ³•åœ¨networkxé‡Œçš„å®ç°ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥æ„é€ ä¸€ä¸ªç®€å•çš„ç½‘ç»œGã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="n">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">G</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span><span class="n">facecolor</span><span class="o">=</span><span class="s">'white'</span><span class="p">)</span>     
<span class="n">pos</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.2</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">]),</span>
 <span class="mi">2</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">]),</span>
 <span class="mi">3</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.4</span><span class="p">,</span>  <span class="mf">0.2</span> <span class="p">]),</span>
 <span class="mi">4</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.8</span><span class="p">]),</span>
 <span class="mi">5</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.6</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">])}</span>

<span class="n">width</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">'weight'</span><span class="p">]</span><span class="o">*</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
<span class="n">edge_labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">([((</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,),</span><span class="n">d</span><span class="p">[</span><span class="s">'weight'</span><span class="p">])</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="p">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
<span class="n">nx</span><span class="p">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span> <span class="n">font_size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nx</span><span class="p">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_size</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">node_color</span> <span class="o">=</span> <span class="s">'green'</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="s">'green'</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s">'solid'</span><span class="p">)</span>
<span class="n">nx</span><span class="p">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">font_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="http://oaf2qt3yk.bkt.clouddn.com/40a357e1d6e57596633312c5d203b665.png" alt="example" /></p>

<p>Jon Kleinbergäº1999å¹´åœ¨Journal of the ACMå‘è¡¨é¢˜ä¸ºAuthoritative sources in a hyperlinked environmentçš„æ–‡ç« <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">1</a></sup>ã€‚</p>

<p>å¯¹äºä¸€ä¸ªç½‘ç»œGï¼š</p>

<ol>
  <li>Certain pages are valuable because they provide information about a topic. These pages are called <code class="language-plaintext highlighter-rouge">authorities</code>, a.</li>
  <li>Other pages are valuable because they tell you where to go to find out about that topic. These pages are called <code class="language-plaintext highlighter-rouge">hubs</code>, h.</li>
</ol>

<blockquote>
  <p>â€œa page is a good hub if it links to good authorities, and a page is a good authority if it is linked to by good hubs.â€</p>
</blockquote>

<p>Hitsç®—æ³•é€šè¿‡è¿­ä»£çš„æ–¹æ³•æ¥è®¡ç®—æƒå¨åº¦aå’Œå¯¼èˆªåº¦hã€‚å…¶ä¸­ï¼š</p>
<ol>
  <li>èŠ‚ç‚¹içš„æƒå¨åº¦$a_i$åˆ©ç”¨æŒ‡å‘å®ƒçš„èŠ‚ç‚¹çš„åœ¨<code class="language-plaintext highlighter-rouge">ä¸Šä¸€è½®</code>çš„å¯¼èˆªåº¦hlastå’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚ $a= \mu L h$</li>
  <li>èŠ‚ç‚¹içš„å¯¼èˆªåº¦$h_i$åˆ©ç”¨æŒ‡å‘å®ƒæŒ‡å‘çš„èŠ‚ç‚¹åœ¨<code class="language-plaintext highlighter-rouge">è¿™ä¸€è½®</code>çš„æƒå¨åº¦$a_i$å’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚$h = \lambda L a$</li>
</ol>

<blockquote>
  <p>The iteration will stop after max_iter iterations or an error tolerance of number_of_nodes(G)*tol has been reached. The HITS algorithm was designed for directed graphs but this algorithm does not check if the input graph is directed and will execute on undirected graphs.</p>
</blockquote>

<p>Hitsç®—æ³•çš„ä¸€ä¸ªä¼˜ç‚¹ï¼š</p>

<blockquote>
  <p>An important observation is that <code class="language-plaintext highlighter-rouge">dead ends</code> or <code class="language-plaintext highlighter-rouge">spider traps</code> do not prevent the HITS iteration from converging to a meaningful pair of vectors. Thus, we can work with Fig. 5.18 directly, with no â€œtaxationâ€ or alteration of the graph needed.<sup id="fnref:mining" role="doc-noteref"><a href="#fn:mining" class="footnote" rel="footnote">2</a></sup></p>
</blockquote>

<p>åœ¨networkxé‡Œï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨<a href="http://networkx.readthedocs.io/en/stable/_modules/networkx/algorithms/link_analysis/hits_alg.html#hits">hitså‡½æ•°</a>æ¥é‡‡ç”¨è¿­ä»£çš„æ–¹å¼å®ç°hitsç®—æ³•ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">hits</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-8</span><span class="p">,</span><span class="n">nstart</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">"""Return HITS hubs and authorities values for nodes.

    The HITS algorithm computes two numbers for a node.
    Authorities estimates the node value based on the incoming links.
    Hubs estimates the node value based on outgoing links.

    Parameters
    ----------
    G : graph
      A NetworkX graph

    max_iter : interger, optional
      Maximum number of iterations in power method.

    tol : float, optional
      Error tolerance used to check convergence in power method iteration.

    nstart : dictionary, optional
      Starting value of each node for power method iteration.

    normalized : bool (default=True)
       Normalize results by the sum of all of the values.

    Returns
    -------
    (hubs,authorities) : two-tuple of dictionaries
       Two dictionaries keyed by node containing the hub and authority
       values.
    """</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="n">nx</span><span class="p">.</span><span class="n">MultiGraph</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="n">nx</span><span class="p">.</span><span class="n">MultiDiGraph</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"hits() not defined for graphs with multiedges."</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{},{}</span>
    <span class="c1"># choose fixed starting vector if not given
</span>    <span class="k">if</span> <span class="n">nstart</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="n">G</span><span class="p">.</span><span class="n">number_of_nodes</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">h</span><span class="o">=</span><span class="n">nstart</span>
        <span class="c1"># normalize starting vector
</span>        <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span> <span class="c1"># power iteration: make up to max_iter iterations
</span>        <span class="n">hlast</span><span class="o">=</span><span class="n">h</span>
        <span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">a</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># this "matrix multiply" looks odd because it is
</span>        <span class="c1"># doing a left multiply a^T=hlast^T*G
</span>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">+=</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># now multiply h=Ga
</span>        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># normalize vector
</span>        <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
        <span class="c1"># normalize vector
</span>        <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
        <span class="c1"># check convergence, l1 norm
</span>        <span class="n">err</span><span class="o">=</span><span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">max_iter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NetworkXError</span><span class="p">(</span>\
            <span class="s">"HITS: power iteration failed to converge in %d iterations."</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*=</span> <span class="n">s</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
            <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*=</span> <span class="n">s</span>
    <span class="k">return</span> <span class="n">h</span><span class="p">,</span><span class="n">a</span>
</code></pre></div></div>

<blockquote>
  <p>h,a=nx.hits(G)</p>
</blockquote>

<h1 id="åˆ†è§£hitsç®—æ³•">åˆ†è§£Hitsç®—æ³•</h1>

<p>é¦–å…ˆï¼Œhitsç®—æ³•æ˜¯ä»å¯¼èˆªé¡µé¢æŠ•ç¥¨ç»™æƒå¨é¡µé¢ã€‚å¦‚æœä¸æŒ‡å®šï¼Œåˆå§‹çš„å¯¼èˆªåº¦hubå–å€¼éƒ½ä¸€æ ·ï¼Œå¦‚ä¸Šå›¾å…±æœ‰äº”ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„hubåˆå§‹å€¼ä¸º0.2ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># choose fixed starting vector if not given
</span><span class="n">nstart</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">if</span> <span class="n">nstart</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="n">G</span><span class="p">.</span><span class="n">number_of_nodes</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">h</span><span class="o">=</span><span class="n">nstart</span>
    <span class="c1"># normalize starting vector
</span>    <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>

<span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{1: 0.2, 2: 0.2, 3: 0.2, 4: 0.2, 5: 0.2}
</code></pre></div></div>

<p>ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡è¿­ä»£çš„æ–¹æ³•æ¥è®¡ç®—æƒå¨åº¦aå’Œå¯¼èˆªåº¦hã€‚å…¶ä¸­ï¼š</p>
<ol>
  <li>èŠ‚ç‚¹içš„æƒå¨åº¦$a_i$åˆ©ç”¨æŒ‡å‘å®ƒçš„èŠ‚ç‚¹çš„åœ¨<code class="language-plaintext highlighter-rouge">ä¸Šä¸€è½®</code>çš„å¯¼èˆªåº¦hlastå’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚</li>
  <li>èŠ‚ç‚¹içš„å¯¼èˆªåº¦$h_i$åˆ©ç”¨æŒ‡å‘å®ƒæŒ‡å‘çš„èŠ‚ç‚¹åœ¨<code class="language-plaintext highlighter-rouge">è¿™ä¸€è½®</code>çš„æƒå¨åº¦$a_i$å’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚</li>
</ol>

<p>æ¯ä¸€è½®è¿­ä»£çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©hlast = hï¼Œç„¶åæ¸…ç©ºhå’Œaã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="n">G</span><span class="p">.</span><span class="n">number_of_nodes</span><span class="p">())</span>
<span class="n">hlast</span><span class="o">=</span><span class="n">h</span>
<span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">h</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>({1: 0, 2: 0, 3: 0, 4: 0, 5: 0}, {1: 0, 2: 0, 3: 0, 4: 0, 5: 0})
</code></pre></div></div>

<p>åœ¨networkxçš„ç½‘ç»œå¯¹è±¡Gä¸­ï¼Œæ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹æ‰€é“¾æ¥çš„å¯¹è±¡å¾ˆå®¹æ˜“ï¼Œæ¯”å¦‚èŠ‚ç‚¹1æ‰€æŒ‡å‘çš„èŠ‚ç‚¹2å’Œ3å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•è·å¾—ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># node 1 points to node 2 and node 3
</span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{2: {'weight': 50}, 3: {'weight': 30}}
</code></pre></div></div>

<p>æŒ‰ç…§ä¸Šé¢çš„ä»‹ç»ï¼š</p>

<blockquote>
  <p>èŠ‚ç‚¹içš„æƒå¨åº¦$a_i$åˆ©ç”¨æŒ‡å‘å®ƒçš„èŠ‚ç‚¹çš„åœ¨<code class="language-plaintext highlighter-rouge">ä¸Šä¸€è½®</code>çš„å¯¼èˆªåº¦hlastå’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># this "matrix multiply" looks odd because it is
# doing a left multiply a^T=hlast^T*G
</span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'node:'</span><span class="p">,</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
        <span class="k">print</span> <span class="n">n</span><span class="p">,</span> <span class="s">' votes for '</span><span class="p">,</span> <span class="n">nbr</span><span class="p">,</span> <span class="s">':'</span><span class="p">,</span>  <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">+=</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">a</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node: 1
1  votes for  2 : 50
1  votes for  3 : 30
node: 2
2  votes for  4 : 20
2  votes for  5 : 30
node: 3
3  votes for  2 : 10
node: 4
4  votes for  5 : 10
node: 5
5  votes for  3 : 5





{1: 0, 2: 108.0, 3: 63.0, 4: 36.0, 5: 72.0}
</code></pre></div></div>

<p>ç±»ä¼¼çš„ï¼ŒæŒ‰ç…§ä»¥ä¸Šé€»è¾‘</p>

<blockquote>
  <p>èŠ‚ç‚¹içš„å¯¼èˆªåº¦$h_i$åˆ©ç”¨æŒ‡å‘å®ƒæŒ‡å‘çš„èŠ‚ç‚¹åœ¨<code class="language-plaintext highlighter-rouge">è¿™ä¸€è½®</code>çš„æƒå¨åº¦$a_i$å’Œé“¾æ¥çš„æƒé‡æ¥å†³å®šã€‚</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># now multiply h=Ga
</span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'node:'</span><span class="p">,</span> <span class="n">n</span>
    <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
        <span class="k">print</span> <span class="n">nbr</span><span class="p">,</span> <span class="s">' votes for '</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s">':'</span><span class="p">,</span>  <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node: 1
2  votes for  1 : 50
3  votes for  1 : 30
node: 2
4  votes for  2 : 20
5  votes for  2 : 30
node: 3
2  votes for  3 : 10
node: 4
5  votes for  4 : 10
node: 5
3  votes for  5 : 5





{1: 26730.0, 2: 10560.0, 3: 3960.0, 4: 2640.0, 5: 1155.0}
</code></pre></div></div>

<p>æ¯ä¸€è½®éƒ½å¯¹è®¡ç®—çš„hå’Œaè¿›è¡Œå½’ä¸€åŒ–ï¼Œ ä½¿å¾—æœ€å¤§å€¼ä¸º1ã€‚</p>

<blockquote>
  <p>While importance is divided among the successors of a page, as expressed by the transition matrix of the Web, the normal way to describe the computation of hubbiness and authority is to add the authority of successors to estimate hubbiness and to add hubbiness of predecessors to estimate authority. If that is all we did, then the hubbiness and authority values would typically grow beyond bounds. Thus, we normally scale the values of the vectors h and a so that the largest component is 1. An alternative is to scale so that the sum of components is 1. <sup id="fnref:mining:1" role="doc-noteref"><a href="#fn:mining" class="footnote" rel="footnote">2</a></sup></p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># normalize vector
</span><span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
<span class="c1"># normalize vector
</span><span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
<span class="n">h</span><span class="p">,</span> <span class="n">a</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>({1: 1.0,
  2: 0.3950617283950617,
  3: 0.14814814814814814,
  4: 0.09876543209876543,
  5: 0.043209876543209874},
 {1: 0.0,
  2: 1.0,
  3: 0.5833333333333333,
  4: 0.3333333333333333,
  5: 0.6666666666666666})
</code></pre></div></div>

<p>å¯ä»¥æ£€æŸ¥æ¯ä¸€è½®è¿­ä»£æ˜¯å¦æ”¶æ•›ï¼Œå³ä¸ä¸Šä¸€æ¬¡ç»“æœç›¸æ¯”ç›¸å·®å¤šå°‘ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># check convergence, l1 norm
</span><span class="n">err</span><span class="o">=</span><span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">])</span>
<span class="n">err</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.3049382716049382
</code></pre></div></div>

<p>å†™ä¸€ä¸ªwhileå¾ªç¯ï¼Œæ¥å®ç°å¤šè½®è¿­ä»£çš„è¿‡ç¨‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tol</span><span class="o">=</span><span class="mf">1.0e-8</span>
<span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span> <span class="c1"># power iteration: make up to max_iter iterations
</span>    <span class="n">hlast</span><span class="o">=</span><span class="n">h</span>
    <span class="n">h</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">a</span><span class="o">=</span><span class="nb">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">hlast</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># this "matrix multiply" looks odd because it is
</span>    <span class="c1"># doing a left multiply a^T=hlast^T*G
</span>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">+=</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># now multiply h=Ga
</span>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nbr</span> <span class="ow">in</span> <span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">+=</span><span class="n">a</span><span class="p">[</span><span class="n">nbr</span><span class="p">]</span><span class="o">*</span><span class="n">G</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">nbr</span><span class="p">].</span><span class="n">get</span><span class="p">(</span><span class="s">'weight'</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># normalize vector
</span>    <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span> <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
    <span class="c1"># normalize vector
</span>    <span class="n">s</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*=</span><span class="n">s</span>
    <span class="c1"># check convergence, l1 norm
</span>    <span class="n">err</span><span class="o">=</span><span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">hlast</span><span class="p">[</span><span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">max_iter</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NetworkXError</span><span class="p">(</span>\
        <span class="s">"HITS: power iteration failed to converge in %d iterations."</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">a</span><span class="p">,</span> <span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>({1: 0.0,
  2: 1.0,
  3: 0.5869771534391885,
  4: 1.2424173865033881e-09,
  5: 2.010273559576297e-09},
 {1: 1.0,
  2: 1.2595387930963707e-09,
  3: 0.14790861375675435,
  4: 2.973367754687863e-10,
  5: 0.04340948853603804})
</code></pre></div></div>

<p>æ³¨æ„ï¼Œæœ€åè¿˜å¯ä»¥æŠŠç®—çš„ç»“æœè¿›è¡Œæ ‡å‡†åŒ–ï¼Œä½¿å¾—åŠ æ€»ä¸º1ã€‚</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">normalized</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*=</span> <span class="n">s</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">h</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">h</span><span class="p">:</span>
        <span class="n">h</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">*=</span> <span class="n">s</span>
<span class="n">a</span><span class="p">,</span> <span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>({1: 0.0,
  2: 0.6301287928331256,
  3: 0.36987120511726024,
  4: 7.828829679522668e-10,
  5: 1.2667312513601625e-09},
 {1: 0.8394063657461127,
  2: 1.0572648808292696e-09,
  3: 0.12415543193610266,
  4: 2.495863820989218e-10,
  5: 0.03643820101093324})
</code></pre></div></div>

<h1 id="computing-hits-with-numpy">Computing hits with numpy</h1>

<p>é™¤äº†é‡‡ç”¨è¿­ä»£çš„æ–¹å¼è®¡ç®—å¤–ï¼Œè¿˜å¯ä»¥é‡‡ç”¨ç‰¹å¾å‘é‡çš„æ–¹æ³•æ¥è®¡ç®—ï¼š</p>

<blockquote>
  <p>The eigenvector calculation is done by the power iteration method and has no guarantee of convergence <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">3</a></sup>.</p>
</blockquote>

<p>å› ä¸ºLLT å’Œ LTL ä¸å¦‚L å’Œ LTé‚£ä¹ˆç¨€ç–, æˆ‘ä»¬é€šå¸¸é‡‡ç”¨è¿­ä»£çš„æ–¹æ³•è®¡ç®—aå’Œhçš„æ–¹æ³•ã€‚ â€œFor Web-sized graphs, the only way of computing the solution to the hubs- and-authorities equations is iteratively.â€<sup id="fnref:mining:2" role="doc-noteref"><a href="#fn:mining" class="footnote" rel="footnote">2</a></sup></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hub_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">nodelist</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""Return the HITS hub matrix."""</span>
    <span class="n">M</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">to_numpy_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="p">.</span><span class="n">T</span>

<span class="k">def</span> <span class="nf">authority_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">nodelist</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="s">"""Return the HITS authority matrix."""</span>
    <span class="n">M</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">to_numpy_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">nodelist</span><span class="o">=</span><span class="n">nodelist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">M</span><span class="p">.</span><span class="n">T</span><span class="o">*</span><span class="n">M</span>

<span class="k">def</span> <span class="nf">hits_numpy</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="s">"""Return HITS hubs and authorities values for nodes.

    The HITS algorithm computes two numbers for a node.
    Authorities estimates the node value based on the incoming links.
    Hubs estimates the node value based on outgoing links.

    Parameters
    ----------
    G : graph
      A NetworkX graph

    normalized : bool (default=True)
       Normalize results by the sum of all of the values.

    Returns
    -------
    (hubs,authorities) : two-tuple of dictionaries
       Two dictionaries keyed by node containing the hub and authority
       values.

    Examples
    --------
    &gt;&gt;&gt; G=nx.path_graph(4)
    &gt;&gt;&gt; h,a=nx.hits(G)

    Notes
    -----
    The eigenvector calculation uses NumPy's interface to LAPACK.

    The HITS algorithm was designed for directed graphs but this
    algorithm does not check if the input graph is directed and will
    execute on undirected graphs.

    References
    ----------
    .. [1] A. Langville and C. Meyer,
       "A survey of eigenvector methods of web information retrieval."
       http://citeseer.ist.psu.edu/713792.html
    .. [2] Jon Kleinberg,
       Authoritative sources in a hyperlinked environment
       Journal of the ACM 46 (5): 604-32, 1999.
       doi:10.1145/324133.324140.
       http://www.cs.cornell.edu/home/kleinber/auth.pdf.
    """</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
    <span class="k">except</span> <span class="nb">ImportError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">ImportError</span><span class="p">(</span>\
            <span class="s">"hits_numpy() requires NumPy: http://scipy.org/"</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{},{}</span>

    <span class="n">H</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">hub_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">e</span><span class="p">,</span><span class="n">ev</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="n">m</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># index of maximum eigenvalue
</span>    <span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span><span class="n">m</span><span class="p">]).</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">A</span><span class="o">=</span><span class="n">nx</span><span class="p">.</span><span class="n">authority_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">e</span><span class="p">,</span><span class="n">ev</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">m</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># index of maximum eigenvalue
</span>    <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span><span class="n">m</span><span class="p">]).</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">h</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">h</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>
    <span class="n">hubs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">(),</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">h</span><span class="p">)))</span>
    <span class="n">authorities</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">(),</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">a</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">hubs</span><span class="p">,</span><span class="n">authorities</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">M</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">to_numpy_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">M</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix([[  0.,  50.,  30.,   0.,   0.],
        [  0.,   0.,   0.,  20.,  30.],
        [  0.,  10.,   0.,   0.,   0.],
        [  0.,   0.,   0.,   0.,  10.],
        [  0.,   0.,   5.,   0.,   0.]])
</code></pre></div></div>

<h2 id="hub">Hub</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">M</span><span class="p">.</span><span class="n">T</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix([[  0.,   0.,   0.,   0.,   0.],
        [ 50.,   0.,  10.,   0.,   0.],
        [ 30.,   0.,   0.,   0.,   5.],
        [  0.,  20.,   0.,   0.,   0.],
        [  0.,  30.,   0.,  10.,   0.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">M</span><span class="o">*</span><span class="p">(</span><span class="n">M</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix([[ 3400.,     0.,   500.,     0.,   150.],
        [    0.,  1300.,     0.,   300.,     0.],
        [  500.,     0.,   100.,     0.,     0.],
        [    0.,   300.,     0.,   100.,     0.],
        [  150.,     0.,     0.,     0.,    25.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">M</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">to_numpy_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">H</span><span class="o">=</span><span class="n">M</span><span class="o">*</span><span class="n">M</span><span class="p">.</span><span class="n">T</span>
<span class="n">H</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix([[ 3400.,     0.,   500.,     0.,   150.],
        [    0.,  1300.,     0.,   300.,     0.],
        [  500.,     0.,   100.,     0.,     0.],
        [    0.,   300.,     0.,   100.,     0.],
        [  150.,     0.,     0.,     0.,    25.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># help(np.linalg.eig)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Compute the eigenvalues and right eigenvectors of a square array.
</span><span class="n">e</span><span class="p">,</span><span class="n">ev</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eig</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="k">print</span> <span class="n">e</span><span class="p">,</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span> <span class="n">ev</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[  3.48046573e+03   1.70539354e-14   4.45342698e+01   1.37082039e+03
   2.91796068e+01]

[[  9.88326948e-01   1.27000127e-01   8.41475633e-02   4.65001400e-17
   -8.49828802e-17]
 [ -1.05348126e-18   1.16684959e-16   1.10797159e-16   9.73248989e-01
   -2.29752921e-01]
 [  1.46182069e-01  -6.35000635e-01  -7.58554544e-01  -5.44128764e-17
    7.42004736e-16]
 [ -1.00917153e-19  -1.99336805e-16  -1.01470190e-15   2.29752921e-01
    9.73248989e-01]
 [  4.29027673e-02  -7.62000762e-01   6.46153381e-01   7.21426956e-17
   -6.86018605e-16]]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># index of maximum eigenvalue
</span><span class="n">m</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span><span class="n">m</span><span class="p">]).</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([  9.88326948e-01,  -1.05348126e-18,   1.46182069e-01,
        -1.00917153e-19,   4.29027673e-02])
</code></pre></div></div>

<h2 id="authority">Authority</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span><span class="o">=</span><span class="n">M</span><span class="p">.</span><span class="n">T</span><span class="o">*</span><span class="n">M</span>
<span class="n">A</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>matrix([[    0.,     0.,     0.,     0.,     0.],
        [    0.,  2600.,  1500.,     0.,     0.],
        [    0.,  1500.,   925.,     0.,     0.],
        [    0.,     0.,     0.,   400.,   600.],
        [    0.,     0.,     0.,   600.,  1000.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">e</span><span class="p">,</span><span class="n">ev</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="n">e</span><span class="p">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># index of maximum eigenvalue
</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span><span class="n">m</span><span class="p">]).</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">a</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ 0.        ,  0.86240802,  0.5062138 ,  0.        ,  0.        ])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">normalized</span> <span class="o">=</span> <span class="bp">True</span>
<span class="k">if</span> <span class="n">normalized</span><span class="p">:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">h</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="n">h</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>
<span class="n">a</span><span class="p">,</span> <span class="n">h</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(array([ 0.        ,  0.63012879,  0.36987121,  0.        ,  0.        ]),
 array([  8.39406367e-01,  -8.94743260e-19,   1.24155432e-01,
         -8.57110097e-20,   3.64382011e-02]))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hubs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">(),</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">h</span><span class="p">)))</span>
<span class="n">authorities</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G</span><span class="p">.</span><span class="n">nodes</span><span class="p">(),</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">a</span><span class="p">)))</span>
<span class="k">print</span> <span class="n">hubs</span><span class="p">,</span><span class="n">authorities</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{1: 0.8394063668430921, 2: -8.94743259991345e-19, 3: 0.12415543209835535, 4: -8.571100967854224e-20, 5: 0.03643820105855254} {1: 0.0, 2: 0.6301287941246466, 3: 0.3698712058753535, 4: 0.0, 5: 0.0}
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hits_numpy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>({1: 0.8394063668430921,
  2: -8.94743259991345e-19,
  3: 0.12415543209835535,
  4: -8.571100967854224e-20,
  5: 0.03643820105855254},
 {1: 0.0, 2: 0.6301287941246466, 3: 0.3698712058753535, 4: 0.0, 5: 0.0})
</code></pre></div></div>

<h1 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h1>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:2" role="doc-endnote">
      <p>Jon Kleinberg, Authoritative sources in a hyperlinked environment. Journal of the ACM 46 (5): 604-32, 1999. doi:10.1145/324133.324140. http://www.cs.cornell.edu/home/kleinber/auth.pdf.Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:mining" role="doc-endnote">
      <p>Jure Leskovec; Anand Rajaraman; Jeffrey D. Ullman. Mining of Massive Datasets. http://www.mmds.orgÂ <a href="#fnref:mining" class="reversefootnote" role="doc-backlink">&#8617;</a>Â <a href="#fnref:mining:1" class="reversefootnote" role="doc-backlink">&#8617;<sup>2</sup></a>Â <a href="#fnref:mining:2" class="reversefootnote" role="doc-backlink">&#8617;<sup>3</sup></a></p>
    </li>
    <li id="fn:1" role="doc-endnote">
      <p>A. Langville and C. Meyer, â€œA survey of eigenvector methods of web information retrieval.â€ http://citeseer.ist.psu.edu/713792.htmlÂ <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>
:ET